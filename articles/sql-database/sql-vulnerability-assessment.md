---
title: SQL-Sicherheitsrisikobewertung
description: Hier erfahren Sie, wie Sie die SQL-Sicherheitsrisikobewertung für Azure SQL-Datenbank konfigurieren und die Bewertungsberichte interpretieren.
services: sql-database
ms.service: sql-database
ms.subservice: security
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: mibar
ms.author: mibar
ms.reviewer: vanto, carlrab
ms.date: 04/19/2020
tags: azure-synapse
ms.openlocfilehash: 80629898b56f81fc738cb30df63766ea39adea6d
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2020
ms.locfileid: "81684250"
---
# <a name="sql-vulnerability-assessment-helps-you-identify-database-vulnerabilities"></a>Ermitteln von Sicherheitsrisiken für die Datenbank mithilfe der SQL-Sicherheitsrisikobewertung

Die SQL-Sicherheitsrisikobewertung ist ein einfach zu konfigurierender Dienst, mit dem potenzielle Sicherheitsrisiken für die Datenbank ermittelt, nachverfolgt und behandelt werden können. Verwenden Sie es zur proaktiven Verbesserung Ihrer Datenbanksicherheit.

Die Sicherheitsrisikobewertung ist Bestandteil des Angebots [Advanced Data Security](sql-database-advanced-data-security.md). Dabei handelt es sich um ein vereinheitlichtes Paket für erweiterte SQL-Sicherheitsfunktionen. Die Sicherheitsrisikobewertung kann über das zentrale SQL Advanced Data Security-Portal geöffnet und verwaltet werden.

> [!NOTE]
> Die Sicherheitsrisikobewertung wird für Azure SQL-Datenbank, für verwaltete Azure SQL-Datenbank-Instanzen und für Azure Synapse Analytics unterstützt. Der Einfachheit halber wird in diesem Artikel der Begriff „SQL-Datenbank“ verwendet, wenn auf einen dieser verwalteten Datenbankdienste Bezug genommen wird.

## <a name="vulnerability-assessment"></a>Sicherheitsrisikobewertung

Die SQL-Sicherheitsrisikobewertung ist ein Dienst, der Aufschluss über Ihren Sicherheitsstatus gibt. Die Sicherheitsrisikobewertung beinhaltet Schritte zur Behebung von Sicherheitsproblemen sowie zur Verbesserung der Datenbanksicherheit. Sie kann Ihnen die Durchführung folgender Aufgaben erleichtern: 

- Erfüllen der Konformitätsanforderungen, die Datenbanküberprüfungs-Berichte erfordern.
- Einhalten von Datenschutzstandards.
- Überwachen einer dynamischen Datenbankumgebung, in der Änderungen schwer zu verfolgen sind.

Die Sicherheitsrisikobewertung ist ein in Azure SQL-Datenbank integrierter Überprüfungsdienst. Der Dienst verwendet eine Wissensdatenbank mit Regeln zur Kennzeichnung von Sicherheitsrisiken. Er hebt Abweichungen von bewährten Methoden hervor (beispielsweise Fehlkonfigurationen, zu hohe Berechtigungen oder ungeschützte vertrauliche Daten).

Die Regeln basieren auf bewährten Methoden von Microsoft und konzentrieren sich auf die Sicherheitsprobleme, die das größte Risiko für Ihre Datenbank und deren wertvolle Daten darstellt. Sie umfassen sowohl Sicherheitsprobleme auf der Datenbankebene als auch Sicherheitsprobleme auf der Serverebene (beispielsweise Serverfirewalleinstellungen oder Berechtigungen auf der Serverebene). Diese Regeln spiegeln darüber hinaus viele Anforderungen verschiedener Aufsichtsbehörden wider, um deren Konformitätsstandards zu erfüllen.

Zu den Ergebnissen der Überprüfung zählen Aktionsschritte zum Beheben der jeweiligen Probleme und ggf. das Bereitstellen benutzerdefinierter Skripts zur Wiederherstellung. Sie können einen Bewertungsbericht für Ihre Umgebung anpassen und eine akzeptable Baseline für Folgendes festlegen:
* Berechtigungskonfigurationen
* Featurekonfigurationen
* Datenbankeinstellungen

## <a name="implement-vulnerability-assessment"></a>Implementieren der Sicherheitsrisikobewertung

Die Sicherheitsrisikobewertung für SQL-Datenbank wird wie folgt implementiert:

### <a name="1-run-a-scan"></a>1. Ausführen einer Überprüfung

Wählen Sie im Bereich Ihrer Azure SQL-Datenbank unter der Überschrift **Sicherheit** die Option **Advanced Data Security** aus. Klicken Sie anschließend im Bereich **Sicherheitsrisikobewertung** auf **Speicher auswählen**, um den Bereich mit den Einstellungen für die Sicherheitsrisikobewertung für die gesamte SQL Server-Instanz zu öffnen.

Konfigurieren Sie ein Speicherkonto zum Speichern der Überprüfungsergebnisse für alle Datenbanken auf dem Server. Weitere Informationen zu Speicherkonten finden Sie unter [Informationen zu Azure-Speicherkonten](../storage/common/storage-create-storage-account.md). Wählen Sie nach dem Konfigurieren des Speichers die Option **Scannen** aus, um Ihre Datenbank auf Sicherheitsrisiken zu überprüfen.

![Überprüfen einer Datenbank](./media/sql-vulnerability-assessment/pp_va_initialize.png)

  > [!NOTE]
  > Die Überprüfung belastet die Ressourcen nicht und ist sicher. Die Ausführung dauert nur wenige Sekunden und ist vollständig schreibgeschützt. Es werden keine Änderungen an Ihrer Datenbank vorgenommen.

### <a name="2-view-the-report"></a>2. Anzeigen des Berichts

Nach Abschluss der Überprüfung wird Ihr Überprüfungsbericht automatisch im Azure-Portal angezeigt. Der Bericht enthält eine Übersicht über Ihren Sicherheitsstatus. Es gibt Aufschluss über die Anzahl gefundener Probleme und den jeweiligen Schweregrad. Zu den Ergebnissen zählen Warnungen zu Abweichungen von bewährten Methoden sowie eine Momentaufnahme Ihrer sicherheitsbezogenen Einstellungen (beispielsweise Datenbankprinzipale und -rollen sowie die zugehörigen Berechtigungen). Der Überprüfungsbericht liefert außerdem eine Zuordnung der in Ihrer Datenbank ermittelten vertraulichen Daten. Er enthält Empfehlungen zur Klassifizierung dieser Daten mittels [Datenermittlung und -klassifizierung](sql-database-data-discovery-and-classification.md).

![Anzeigen des Berichts](./media/sql-vulnerability-assessment/pp_main_getstarted.png)

### <a name="3-analyze-the-results-and-resolve-issues"></a>3. Analysieren der Ergebnisse und Beheben der Probleme

Überprüfen Sie Ihre Ergebnisse, und ermitteln Sie, bei welchen Ergebnissen im Bericht es sich um tatsächliche Sicherheitsprobleme in Ihrer Umgebung handelt. Führen Sie einen Drilldown für jedes fehlerhafte Ergebnis aus, um die Auswirkung des Ergebnisses und die Gründe für die Fehler bei den Sicherheitsüberprüfungen nachvollziehen zu können. Nutzen Sie die Informationen des Berichts zu Wiederherstellungsaktionen, um das Problem zu beheben.

![Analysieren des Berichts](./media/sql-vulnerability-assessment/pp_fail_rule_show_remediation.png)

### <a name="4-set-your-baseline"></a>4. Festlegen Ihrer Baseline

Bei der Überprüfung Ihrer Bewertungsergebnisse können Sie bestimmte Ergebnisse als akzeptable *Baseline* für Ihre Umgebung markieren. Die Baseline ist im Wesentlichen eine Anpassung der Art, in der die Ergebnisse berichtet werden. Wenn Ergebnisse in nachfolgenden Überprüfungen mit der Baseline übereinstimmen, wird dies als Bestehen gewertet. Nach dem Festlegen des Baseline-Sicherheitsstatus meldet die Sicherheitsrisikobewertung nur noch Abweichungen von der Baseline. Dadurch können Sie sich auf die relevanten Probleme konzentrieren.

![Festlegen Ihrer Baseline](./media/sql-vulnerability-assessment/pp_fail_rule_show_baseline.png)

### <a name="5-run-a-new-scan-to-see-your-customized-tracking-report"></a>5. Ausführen einer neuen Überprüfung zum Anzeigen Ihres benutzerdefinierten Nachverfolgungsberichts

Führen Sie nach der Einrichtung der **Baselines für Ihre Regeln** eine neue Überprüfung aus, um den benutzerdefinierten Bericht anzuzeigen. Die Sicherheitsrisikobewertung meldet jetzt nur noch die Sicherheitsprobleme, die von Ihrem genehmigten Baselinestatus abweichen.

![Anzeige des benutzerdefinierten Berichts](./media/sql-vulnerability-assessment/pp_pass_main_with_baselines.png)

Die Sicherheitsrisikobewertung kann nun verwendet werden, um zu überwachen, dass Ihre Datenbank jederzeit über ein hohes Maß an Sicherheit verfügt und dass die Organisationsrichtlinien erfüllt werden. Wenn Konformitätsberichte erforderlich sind, können Berichte der Sicherheitsrisikobewertung zur Vereinfachung des Konformitätsprozesses beitragen.

### <a name="6-set-up-periodic-recurring-scans"></a>6. Einrichten von regelmäßig wiederkehrenden Überprüfungen

Navigieren Sie zu den Einstellungen der Sicherheitsrisikobewertung, um **Regelmäßig wiederkehrende Überprüfungen** zu aktivieren. Durch diese Einstellung wird die Sicherheitsrisikobewertung so konfiguriert, dass einmal pro Woche automatisch eine Überprüfung der Datenbank erfolgt. Eine Zusammenfassung der Überprüfungsergebnisse wird an die angegebenen E-Mail-Adressen gesendet.

![Anzeige des benutzerdefinierten Berichts](./media/sql-vulnerability-assessment/pp_recurring_scans.png)

### <a name="7-export-an-assessment-report"></a>7. Exportieren eines Bewertungsberichts

Wählen Sie **Überprüfungsergebnisse exportieren** aus, um einen herunterladbaren Excel-Bericht der Überprüfungsergebnisse zu erstellen. Dieser Bericht enthält eine Registerkarte mit einer Zusammenfassung der Bewertung – einschließlich aller Überprüfungen mit Fehlern. Er enthält auch die Registerkarte **Ergebnisse** mit den vollständigen Ergebnissen der Überprüfung. Die Ergebnisse beinhalten alle ausgeführten Überprüfungen und die jeweiligen Ergebnisdetails.

### <a name="8-view-scan-history"></a>8. Anzeigen des Überprüfungsverlaufs

Wählen Sie im Bereich der Sicherheitsrisikobewertung die Option **Überprüfungsverlauf** aus, um einen Verlauf aller zuvor für diese Datenbank ausgeführten Überprüfungen anzuzeigen. Wählen Sie eine bestimmte Überprüfung in der Liste aus, um die ausführlichen Ergebnisse dieser Überprüfung anzuzeigen.

Die Sicherheitsrisikobewertung kann nun verwendet werden, um zu überwachen, dass Ihre Datenbank jederzeit über ein hohes Maß an Sicherheit verfügt und dass die Organisationsrichtlinien erfüllt werden. Wenn Konformitätsberichte erforderlich sind, können Berichte der Sicherheitsrisikobewertung zur Vereinfachung des Konformitätsprozesses beitragen.

## <a name="manage-vulnerability-assessments-by-using-azure-powershell"></a>Verwalten der Sicherheitsrisikobewertungen mithilfe von Azure PowerShell

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]
> [!IMPORTANT]
> Das PowerShell Azure Resource Manager-Modul wird von Azure SQL-Datenbank weiterhin unterstützt, aber alle zukünftigen Entwicklungen erfolgen für das Az.Sql-Modul. Informationen zu diesen Cmdlets finden Sie unter [AzureRM.Sql](https://docs.microsoft.com/powershell/module/AzureRM.Sql/). Die Argumente für die Befehle im Az-Modul und den AzureRm-Modulen sind im Wesentlichen identisch.

Sie können die Azure PowerShell-Cmdlets verwenden, um Ihre Sicherheitsrisikobewertungen programmgesteuert zu verwalten. Die unterstützten Cmdlets sind die folgenden:

| Cmdlet-Name als Link | BESCHREIBUNG |
| :-------------------- | :---------- |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Löscht die Baseline für die Regel zur Sicherheitsrisikobewertung.<br/>Legen Sie zunächst die Baseline fest, bevor Sie dieses Cmdlet zum Löschen verwenden. |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting) | Löscht die Einstellungen für die Sicherheitsrisikobewertung einer Datenbank. |
| [Convert-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan) | Konvertiert die Überprüfungsergebnisse der Sicherheitsrisikobewertung in eine Excel-Datei. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Ruft die Baseline für die Regel zur Sicherheitsrisikobewertung für eine angegebene Regel ab. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentScanRecord](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord) | Ruft alle Überprüfungsdatensätze für die Sicherheitsrisikobewertung ab, die der angegebenen Datenbank zugeordnet sind. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting) | Gibt die Einstellungen für die Sicherheitsrisikobewertung einer Datenbank zurück. |
| [Set-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Legt die Baseline für die Regel zur Sicherheitsrisikobewertung fest. |
| [Start-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan) | Löst den Start einer Sicherheitsrisikobewertungsüberprüfung aus. |
| [Update-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting) | Aktualisiert die Einstellungen für die Sicherheitsrisikobewertung einer Datenbank. |
| &nbsp; | &nbsp; |

Ein Skriptbeispiel finden Sie im Blogbeitrag [Azure SQL Vulnerability Assessment PowerShell support (SQL-Sicherheitsrisikobewertung: Unterstützung für PowerShell)](https://blogs.msdn.microsoft.com/sqlsecurity/20../../azure-sql-vulnerability-assessment-now-with-powershell-support/).

## <a name="manage-vulnerability-assessment-baseline-rules-by-using-resource-manager-templates"></a>Verwalten von Baselineregeln der Sicherheitsrisikobewertung mithilfe von Resource Manager-Vorlagen

Wenn Sie mithilfe von Azure Resource Manager-Vorlagen Baselines für Sicherheitsrisikobewertungen konfigurieren, müssen Sie den `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines`-Typ verwenden.

Vergewissern Sie sich vor dem Hinzufügen von Baselines, dass auf dem Computer, auf dem SQL Server ausgeführt wird, `vulnerabilityAssessments` aktiviert ist.

Das folgende Beispiel zeigt das Definieren der Baselineregel VA2065 für die Masterdatenbank und der Regel VA1143 für die Benutzerdatenbank als Ressourcen in einer Resource Manager-Vorlage:

```json
   "resources": [
      {
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "FirewallRuleName3",
                     "StartIpAddress",
                     "EndIpAddress"
                  ]
               },
               {
                  "result": [
                     "FirewallRuleName4",
                     "62.92.15.68",
                     "62.92.15.68"
                  ]
               }
            ]
         },
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
         "dependsOn": [
            "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
         ],
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "dbo"
                  ]
               }
            ]
         }
      }
   ]
```

Für die Master- und die Benutzerdatenbank werden die Ressourcennamen unterschiedlich definiert:

* Masterdatenbank: "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/<b>master</b>')]",
* Benutzerdatenbank: "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/<b>default</b>')]",
 
 
 Um boolesche Typen als „true/false“ zu behandeln, legen Sie das Baselineergebnis mit binärer Eingabe (beispielsweise „1“/„0“) fest.
 
```json
   {
      "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
      "apiVersion": "2018-06-01-preview",
      "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",

      "dependsOn": [
         "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
      ],

      "properties": {
         "baselineResults": [
            {
               "result": [
                  "1"
               ]
            }
         ]
      }

   }
```

## <a name="next-steps"></a>Nächste Schritte  

- Erfahren Sie mehr über [Advanced Data Security](sql-database-advanced-data-security.md).
- Informieren Sie sich ausführlicher über die [Datenermittlung und -klassifizierung](sql-database-data-discovery-and-classification.md).
