---
title: SQL-Sicherheitsrisikobewertung
titleSuffix: Azure SQL Database & SQL Managed Instance & Azure Synapse Analytics
description: Hier erfahren Sie, wie Sie die SQL-Sicherheitsrisikobewertung konfigurieren und die Bewertungsberichte für Azure SQL-Datenbank, Azure SQL Managed Instance und Azure Synapse Analytics interpretieren.
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.custom: sqldbrb=3
ms.devlang: ''
ms.topic: how-to
author: mibar
ms.author: mibar
ms.reviewer: vanto
ms.date: 09/21/2020
tags: azure-synapse
ms.openlocfilehash: f3ca5c1bab503693ffed39d096a3dfd5f30046ad
ms.sourcegitcommit: 4bebbf664e69361f13cfe83020b2e87ed4dc8fa2
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 10/01/2020
ms.locfileid: "91619507"
---
# <a name="sql-vulnerability-assessment-helps-you-identify-database-vulnerabilities"></a>Ermitteln von Sicherheitsrisiken für die Datenbank mithilfe der SQL-Sicherheitsrisikobewertung
[!INCLUDE[appliesto-sqldb-sqlmi](../includes/appliesto-sqldb-sqlmi.md)]

Die SQL-Sicherheitsrisikobewertung ist ein einfach zu konfigurierender Dienst, mit dem potenzielle Sicherheitsrisiken für die Datenbank ermittelt, nachverfolgt und behandelt werden können. Verwenden Sie es zur proaktiven Verbesserung Ihrer Datenbanksicherheit.

Die Sicherheitsrisikobewertung ist Bestandteil von [Azure Defender für SQL](azure-defender-for-sql.md). Dabei handelt es sich um ein vereinheitlichtes Paket mit erweiterten SQL-Sicherheitsfunktionen. Der Zugriff auf die Sicherheitsrisikobewertung und ihre Verwaltung sind über das Azure Defender für SQL-Portal möglich.

> [!NOTE]
> Die Sicherheitsrisikobewertung wird für Azure SQL-Datenbank, Azure SQL Managed Instance und Azure Synapse Analytics (zuvor SQL Data Warehouse) unterstützt. Datenbanken in Azure SQL-Datenbank, Azure SQL Managed Instance und Azure Synapse Analytics werden im restlichen Teil dieses Artikels kollektiv als Datenbanken bezeichnet, und der Server bezieht sich auf den [Server](logical-servers.md), auf dem die Datenbanken für Azure SQL-Datenbank und Azure Synapse gehostet werden.

## <a name="vulnerability-assessment"></a>Sicherheitsrisikobewertung

Die SQL-Sicherheitsrisikobewertung ist ein Dienst, der Aufschluss über Ihren Sicherheitsstatus gibt. Die Sicherheitsrisikobewertung beinhaltet Schritte zur Behebung von Sicherheitsproblemen sowie zur Verbesserung der Datenbanksicherheit. Sie kann Ihnen die Durchführung folgender Aufgaben erleichtern:

- Erfüllen der Konformitätsanforderungen, die Datenbanküberprüfungs-Berichte erfordern.
- Einhalten von Datenschutzstandards.
- Überwachen einer dynamischen Datenbankumgebung, in der Änderungen schwer zu verfolgen sind.

Die Sicherheitsrisikobewertung ist ein in Azure SQL-Datenbank integrierter Überprüfungsdienst. Der Dienst verwendet eine Wissensdatenbank mit Regeln zur Kennzeichnung von Sicherheitsrisiken. Er hebt Abweichungen von bewährten Methoden hervor (beispielsweise Fehlkonfigurationen, zu hohe Berechtigungen oder ungeschützte vertrauliche Daten).

Die Regeln basieren auf bewährten Methoden von Microsoft und konzentrieren sich auf die Sicherheitsprobleme, die das größte Risiko für Ihre Datenbank und deren wertvolle Daten darstellt. Sie umfassen sowohl Sicherheitsprobleme auf der Datenbankebene als auch Sicherheitsprobleme auf der Serverebene (beispielsweise Serverfirewalleinstellungen oder Berechtigungen auf der Serverebene). Diese Regeln spiegeln darüber hinaus viele Anforderungen verschiedener Aufsichtsbehörden wider, um deren Konformitätsstandards zu erfüllen.

Zu den Ergebnissen der Überprüfung zählen Aktionsschritte zum Beheben der jeweiligen Probleme und ggf. das Bereitstellen benutzerdefinierter Skripts zur Wiederherstellung. Sie können einen Bewertungsbericht für Ihre Umgebung anpassen und eine akzeptable Baseline für Folgendes festlegen:

- Berechtigungskonfigurationen
- Featurekonfigurationen
- Datenbankeinstellungen

## <a name="implement-vulnerability-assessment"></a>Implementieren der Sicherheitsrisikobewertung

Die folgenden Schritte dienen zur Implementierung der Sicherheitsrisikobewertung:

### <a name="1-run-a-scan"></a>1. Ausführen einer Überprüfung

1. Öffnen Sie Ihre Azure SQL-Datenbank-, SQL Managed Instance- oder Azure Synapse-Ressource im [Azure-Portal](https://portal.azure.com).

1. Wählen Sie unter der Überschrift **Sicherheit** die Option **Security Center** aus.

1. Klicken Sie anschließend im Bereich **Sicherheitsrisikobewertung** auf **Speicher auswählen**, um den Bereich mit den Einstellungen für die Sicherheitsrisikobewertung entweder für den gesamten Server oder die verwaltete Instanz zu öffnen.  

    > [!NOTE]
    > Weitere Informationen zum Speichern von Überprüfungen zur Sicherheitsrisikobewertung hinter Firewalls und VNETs finden Sie unter [Speichern der Ergebnisse von Überprüfungen zur Sicherheitsrisikobewertung in einem Speicherkonto, auf das hinter Firewalls oder VNETs zugegriffen werden kann](sql-database-vulnerability-assessment-storage.md).

1. Konfigurieren Sie ein Speicherkonto zum Speichern der Überprüfungsergebnisse für alle Datenbanken auf dem Server oder in der verwalteten Instanz. Weitere Informationen zu Speicherkonten finden Sie unter [Informationen zu Azure-Speicherkonten](../../storage/common/storage-account-create.md). Wählen Sie nach dem Konfigurieren des Speichers die Option **Scannen** aus, um Ihre Datenbank auf Sicherheitsrisiken zu überprüfen.

![Überprüfen einer Datenbank](./media/sql-vulnerability-assessment/pp_va_initialize.png)

  > [!NOTE]
  > Die Überprüfung belastet die Ressourcen nicht und ist sicher. Die Ausführung dauert nur wenige Sekunden und ist vollständig schreibgeschützt. Es werden keine Änderungen an Ihrer Datenbank vorgenommen.

### <a name="2-view-the-report"></a>2. Anzeigen des Berichts

Nach Abschluss der Überprüfung wird Ihr Überprüfungsbericht automatisch im Azure-Portal angezeigt. Der Bericht enthält eine Übersicht über Ihren Sicherheitsstatus. Es gibt Aufschluss über die Anzahl gefundener Probleme und den jeweiligen Schweregrad. Zu den Ergebnissen zählen Warnungen zu Abweichungen von bewährten Methoden sowie eine Momentaufnahme Ihrer sicherheitsbezogenen Einstellungen (beispielsweise Datenbankprinzipale und -rollen sowie die zugehörigen Berechtigungen). Der Überprüfungsbericht liefert außerdem eine Zuordnung der in Ihrer Datenbank ermittelten vertraulichen Daten. Er enthält Empfehlungen zur Klassifizierung dieser Daten mittels [Datenermittlung und -klassifizierung](data-discovery-and-classification-overview.md).

![Anzeigen des Berichts](./media/sql-vulnerability-assessment/pp_main_getstarted.png)

### <a name="3-analyze-the-results-and-resolve-issues"></a>3. Analysieren der Ergebnisse und Beheben der Probleme

Überprüfen Sie Ihre Ergebnisse, und ermitteln Sie, bei welchen Ergebnissen im Bericht es sich um tatsächliche Sicherheitsprobleme in Ihrer Umgebung handelt. Führen Sie einen Drilldown für jedes fehlerhafte Ergebnis aus, um die Auswirkung des Ergebnisses und die Gründe für die Fehler bei den Sicherheitsüberprüfungen nachvollziehen zu können. Nutzen Sie die Informationen des Berichts zu Wiederherstellungsaktionen, um das Problem zu beheben.

![Analysieren des Berichts](./media/sql-vulnerability-assessment/pp_fail_rule_show_remediation.png)

### <a name="4-set-your-baseline"></a>4. Festlegen Ihrer Baseline

Bei der Überprüfung Ihrer Bewertungsergebnisse können Sie bestimmte Ergebnisse als akzeptable *Baseline* für Ihre Umgebung markieren. Die Baseline ist im Wesentlichen eine Anpassung der Art, in der die Ergebnisse berichtet werden. Wenn Ergebnisse in nachfolgenden Überprüfungen mit der Baseline übereinstimmen, wird dies als Bestehen gewertet. Nach dem Festlegen des Baseline-Sicherheitsstatus meldet die Sicherheitsrisikobewertung nur noch Abweichungen von der Baseline. Dadurch können Sie sich auf die relevanten Probleme konzentrieren.

![Festlegen Ihrer Baseline](./media/sql-vulnerability-assessment/pp_fail_rule_show_baseline.png)

### <a name="5-run-a-new-scan-to-see-your-customized-tracking-report"></a>5. Ausführen einer neuen Überprüfung zum Anzeigen Ihres benutzerdefinierten Nachverfolgungsberichts

Führen Sie nach der Einrichtung der **Baselines für Ihre Regeln** eine neue Überprüfung aus, um den benutzerdefinierten Bericht anzuzeigen. Die Sicherheitsrisikobewertung meldet jetzt nur noch die Sicherheitsprobleme, die von Ihrem genehmigten Baselinestatus abweichen.

![Anzeige des benutzerdefinierten Berichts](./media/sql-vulnerability-assessment/pp_pass_main_with_baselines.png)

Die Sicherheitsrisikobewertung kann nun verwendet werden, um zu überwachen, dass Ihre Datenbank jederzeit über ein hohes Maß an Sicherheit verfügt und dass die Organisationsrichtlinien erfüllt werden. Wenn Konformitätsberichte erforderlich sind, können Berichte der Sicherheitsrisikobewertung zur Vereinfachung des Konformitätsprozesses beitragen.

### <a name="6-set-up-periodic-recurring-scans"></a>6. Einrichten von regelmäßig wiederkehrenden Überprüfungen

Navigieren Sie zu den Einstellungen der Sicherheitsrisikobewertung, um **Regelmäßig wiederkehrende Überprüfungen** zu aktivieren. Durch diese Einstellung wird die Sicherheitsrisikobewertung so konfiguriert, dass einmal pro Woche automatisch eine Überprüfung der Datenbank erfolgt. Eine Zusammenfassung der Überprüfungsergebnisse wird an die angegebenen E-Mail-Adressen gesendet.

![Einstellung für regelmäßige Überprüfungen](./media/sql-vulnerability-assessment/pp_recurring_scans.png)

### <a name="7-export-an-assessment-report"></a>7. Exportieren eines Bewertungsberichts

Wählen Sie **Überprüfungsergebnisse exportieren** aus, um einen herunterladbaren Excel-Bericht der Überprüfungsergebnisse zu erstellen. Dieser Bericht enthält eine Registerkarte mit einer Zusammenfassung der Bewertung – einschließlich aller Überprüfungen mit Fehlern. Er enthält auch die Registerkarte **Ergebnisse** mit den vollständigen Ergebnissen der Überprüfung. Die Ergebnisse beinhalten alle ausgeführten Überprüfungen und die jeweiligen Ergebnisdetails.

### <a name="8-view-scan-history"></a>8. Anzeigen des Überprüfungsverlaufs

Wählen Sie im Bereich der Sicherheitsrisikobewertung die Option **Überprüfungsverlauf** aus, um einen Verlauf aller zuvor für diese Datenbank ausgeführten Überprüfungen anzuzeigen. Wählen Sie eine bestimmte Überprüfung in der Liste aus, um die ausführlichen Ergebnisse dieser Überprüfung anzuzeigen.

Die Sicherheitsrisikobewertung kann nun verwendet werden, um zu überwachen, dass Ihre Datenbank jederzeit über ein hohes Maß an Sicherheit verfügt und dass die Organisationsrichtlinien erfüllt werden. Wenn Konformitätsberichte erforderlich sind, können Berichte der Sicherheitsrisikobewertung zur Vereinfachung des Konformitätsprozesses beitragen.

## <a name="manage-vulnerability-assessments-by-using-azure-powershell"></a>Verwalten der Sicherheitsrisikobewertungen mithilfe von Azure PowerShell

[!INCLUDE [updated-for-az](../../../includes/updated-for-az.md)]
> [!IMPORTANT]
> Das Azure Resource Manager-Modul von PowerShell wird weiterhin unterstützt, aber alle zukünftigen Entwicklungen erfolgen für das Az.Sql-Modul. Informationen zu diesen Cmdlets finden Sie unter [AzureRM.Sql](https://docs.microsoft.com/powershell/module/AzureRM.Sql/). Die Argumente für die Befehle im Az-Modul und den AzureRm-Modulen sind im Wesentlichen identisch.

Sie können die Azure PowerShell-Cmdlets verwenden, um Ihre Sicherheitsrisikobewertungen programmgesteuert zu verwalten. Die unterstützten Cmdlets sind die folgenden:

| Cmdlet-Name als Link | BESCHREIBUNG |
| :-------------------- | :---------- |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Löscht die Baseline für die Regel zur Sicherheitsrisikobewertung.<br/>Legen Sie zunächst die Baseline fest, bevor Sie dieses Cmdlet zum Löschen verwenden. |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting) | Löscht die Einstellungen für die Sicherheitsrisikobewertung einer Datenbank. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Löscht die Baseline für die Regel zur Sicherheitsrisikobewertung einer verwalteten Datenbank.<br/>Legen Sie zunächst die Baseline fest, bevor Sie dieses Cmdlet zum Löschen verwenden. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Löscht die Einstellungen der Sicherheitsrisikobewertung einer verwalteten Datenbank. |
| [Clear-AzSqlInstanceVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Clear-AzSqlInstanceVulnerabilityAssessmentSetting) | Löscht die Einstellungen der Sicherheitsrisikobewertung einer verwalteten Instanz. |
| [Convert-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan) | Konvertiert die Überprüfungsergebnisse der Sicherheitsrisikobewertung einer Datenbank in eine Excel-Datei. |
| [Convert-AzSqlInstanceDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Convert-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | Konvertiert die Überprüfungsergebnisse der Sicherheitsrisikobewertung einer verwalteten Datenbank in eine Excel-Datei. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Ruft die Baseline für die Regel zur Sicherheitsrisikobewertung einer Datenbank für eine angegebene Regel ab. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Ruft die Baseline für die Regel zur Sicherheitsrisikobewertung einer verwalteten Datenbank für eine angegebene Regel ab. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentScanRecord](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord) | Ruft alle Überprüfungsdatensätze für die Sicherheitsrisikobewertung ab, die der angegebenen Datenbank zugeordnet sind. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord](https://docs.microsoft.com/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord) | Ruft alle Überprüfungsdatensätze für die Sicherheitsrisikobewertung ab, die der angegebenen verwalteten Datenbank zugeordnet sind. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting) | Gibt die Einstellungen für die Sicherheitsrisikobewertung einer Datenbank zurück. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Gibt die Einstellungen der Sicherheitsrisikobewertung einer verwalteten Datenbank zurück. |
| [Set-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Legt die Baseline für die Regel zur Sicherheitsrisikobewertung fest. |
| [Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Legt die Baseline für die Regel zur Sicherheitsrisikobewertung einer verwalteten Datenbank fest. |
| [Start-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan) | Löst den Start einer Überprüfung zur Sicherheitsrisikobewertung einer Datenbank aus. |
| [Start-AzSqlInstanceDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Start-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | Löst den Start einer Überprüfung zur Sicherheitsrisikobewertung einer verwalteten Datenbank aus. |
| [Update-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting) | Aktualisiert die Einstellungen für die Sicherheitsrisikobewertung einer Datenbank. |
| [Update-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Update-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Aktualisiert die Einstellungen der Sicherheitsrisikobewertung einer verwalteten Datenbank. |
| [Update-AzSqlInstanceVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Update-AzSqlInstanceVulnerabilityAssessmentSetting) | Aktualisiert die Einstellungen der Sicherheitsrisikobewertung einer verwalteten Instanz. |
| &nbsp; | &nbsp; |

Ein Skriptbeispiel finden Sie im Blogbeitrag [Azure SQL Vulnerability Assessment PowerShell support (SQL-Sicherheitsrisikobewertung: Unterstützung für PowerShell)](https://blogs.msdn.microsoft.com/sqlsecurity/20../../azure-sql-vulnerability-assessment-now-with-powershell-support/).

## <a name="manage-vulnerability-assessment-baseline-rules-by-using-resource-manager-templates"></a>Verwalten von Baselineregeln der Sicherheitsrisikobewertung mithilfe von Resource Manager-Vorlagen

Wenn Sie mithilfe von Azure Resource Manager-Vorlagen Baselines für Sicherheitsrisikobewertungen konfigurieren, müssen Sie den `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines`-Typ verwenden.

Stellen Sie sicher, dass Sie `vulnerabilityAssessments` aktiviert haben, bevor Sie die Grundwerte hinzufügen.

Das folgende Beispiel veranschaulicht, wie die Baselineregel VA2065 für die `master`-Datenbank und die Baselineregel VA1143 für die `user`-Datenbank als Ressourcen in einer Resource Manager-Vorlage definiert werden.

```json
   "resources": [
      {
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "FirewallRuleName3",
                     "StartIpAddress",
                     "EndIpAddress"
                  ]
               },
               {
                  "result": [
                     "FirewallRuleName4",
                     "62.92.15.68",
                     "62.92.15.68"
                  ]
               }
            ]
         },
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
         "dependsOn": [
            "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
         ],
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "dbo"
                  ]
               }
            ]
         }
      }
   ]
```

Für die `master`- und die `user`-Datenbank werden die Ressourcennamen unterschiedlich definiert:

- Masterdatenbank: "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/<b>master</b>')]",
- Benutzerdatenbank: "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/<b>default</b>')]",

Um boolesche Typen als „true/false“ zu behandeln, legen Sie das Baselineergebnis mit binärer Eingabe (beispielsweise „1“/„0“) fest.

```json
   {
      "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
      "apiVersion": "2018-06-01-preview",
      "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",

      "dependsOn": [
         "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
      ],

      "properties": {
         "baselineResults": [
            {
               "result": [
                  "1"
               ]
            }
         ]
      }

   }
```

## <a name="next-steps"></a>Nächste Schritte  

- Weitere Informationen zu [Azure Defender für SQL](azure-defender-for-sql.md).
- Informieren Sie sich ausführlicher über die [Datenermittlung und -klassifizierung](data-discovery-and-classification-overview.md).
- Erfahren Sie mehr über das [Speichern der Ergebnisse von Überprüfungen zur Sicherheitsrisikobewertung in einem Speicherkonto, auf das hinter Firewalls und VNETs zugegriffen werden kann](sql-database-vulnerability-assessment-storage.md).
