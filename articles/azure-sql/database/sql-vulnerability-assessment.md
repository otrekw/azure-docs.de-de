---
title: SQL-Sicherheitsrisikobewertung
titleSuffix: Azure SQL Database & SQL Managed Instance & Azure Synapse Analytics
description: Erfahren Sie, wie Sie die SQL-Sicherheitsrisikobewertung konfigurieren und die Bewertungsberichte für Azure SQL-Datenbank, Azure SQL Managed Instance und Azure Synapse Analytics interpretieren.
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.custom: sqldbrb=3
ms.devlang: ''
ms.topic: how-to
author: davidtrigano
ms.author: datrigan
ms.reviewer: vanto
ms.date: 02/11/2021
tags: azure-synapse
ms.openlocfilehash: 1719c5a7112ee32f86d0593d274a59638cf81a0e
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 03/19/2021
ms.locfileid: "100376611"
---
# <a name="sql-vulnerability-assessment-helps-you-identify-database-vulnerabilities"></a>Ermitteln von Sicherheitsrisiken für die Datenbank mithilfe der SQL-Sicherheitsrisikobewertung
[!INCLUDE[appliesto-sqldb-sqlmi-asa](../includes/appliesto-sqldb-sqlmi-asa.md)]

Die SQL-Sicherheitsrisikobewertung ist ein einfach zu konfigurierender Dienst, mit dem potenzielle Sicherheitsrisiken für die Datenbank ermittelt, nachverfolgt und behandelt werden können. Verwenden Sie es zur proaktiven Verbesserung Ihrer Datenbanksicherheit.

Die Sicherheitsrisikobewertung ist Bestandteil von [Azure Defender für SQL](azure-defender-for-sql.md). Dabei handelt es sich um ein vereinheitlichtes Paket mit erweiterten SQL-Sicherheitsfunktionen. Der Zugriff auf die Sicherheitsrisikobewertung und ihre Verwaltung sind über das Azure Defender für SQL-Portal möglich.

> [!NOTE]
> Die Sicherheitsrisikobewertung wird für Azure SQL-Datenbank, Azure SQL Managed Instance und Azure Synapse Analytics unterstützt. Datenbanken in Azure SQL-Datenbank, Azure SQL Managed Instance und Azure Synapse Analytics werden im restlichen Teil dieses Artikels kollektiv als Datenbanken bezeichnet, und der Server bezieht sich auf den [Server](logical-servers.md), auf dem die Datenbanken für Azure SQL-Datenbank und Azure Synapse gehostet werden.

## <a name="what-is-sql-vulnerability-assessment"></a>Was ist die SQL-Sicherheitsrisikobewertung?

Die SQL-Sicherheitsrisikobewertung ist ein Dienst, der Aufschluss über Ihren Sicherheitsstatus gibt. Die Sicherheitsrisikobewertung beinhaltet Schritte zur Behebung von Sicherheitsproblemen sowie zur Verbesserung der Datenbanksicherheit. Sie kann Ihnen helfen, eine dynamische Datenbankumgebung zu überwachen, in der Änderungen schwierig nachzuverfolgen sind, und so den SQL-Sicherheitsstatus zu verbessern.

Die Sicherheitsrisikobewertung ist ein in Azure SQL-Datenbank integrierter Überprüfungsdienst. Der Dienst verwendet eine Wissensdatenbank mit Regeln zur Kennzeichnung von Sicherheitsrisiken. Er hebt Abweichungen von bewährten Methoden hervor (beispielsweise Fehlkonfigurationen, zu hohe Berechtigungen oder ungeschützte vertrauliche Daten).

Die Regeln basieren auf bewährten Methoden von Microsoft und konzentrieren sich auf die Sicherheitsprobleme, die das größte Risiko für Ihre Datenbank und deren wertvolle Daten darstellt. Sie umfassen sowohl Sicherheitsprobleme auf der Datenbankebene als auch Sicherheitsprobleme auf der Serverebene (beispielsweise Serverfirewalleinstellungen oder Berechtigungen auf der Serverebene).

Zu den Ergebnissen der Überprüfung zählen Aktionsschritte zum Beheben der jeweiligen Probleme und ggf. das Bereitstellen benutzerdefinierter Skripts zur Wiederherstellung. Sie können einen Bewertungsbericht für Ihre Umgebung anpassen und eine akzeptable Baseline für Folgendes festlegen:

- Berechtigungskonfigurationen
- Featurekonfigurationen
- Datenbankeinstellungen

## <a name="configure-vulnerability-assessment"></a>Konfigurieren der Sicherheitsrisikobewertung

Führen Sie die folgenden Schritte aus, um die Sicherheitsrisikobewertung zu konfigurieren:

1. Öffnen Sie im [Azure-Portal](https://portal.azure.com) die spezifische Ressource in Azure SQL-Datenbank, SQL Managed Instance-Datenbank oder Azure Synapse.

1. Wählen Sie unter der Überschrift **Sicherheit** die Option **Security Center** aus.

1. Wählen Sie dann im Link **Konfigurieren** aus, um den Einstellungsbereich von Azure Defender für SQL für den gesamten Server oder die verwaltete Instanz zu öffnen.

    :::image type="content" source="media/sql-vulnerability-assessment/opening-sql-configuration.png" alt-text="Öffnen der Konfiguration von Azure Defender für SQL":::

    > [!NOTE]
    > Die SQL-Sicherheitsrisikobewertung erfordert einen **Azure Defender für SQL**-Plan, um die Ausführung von Überprüfungen zu ermöglichen. Weitere Informationen zum Aktivieren von Azure Defender für SQL finden Sie unter [Azure Defender für SQL](azure-defender-for-sql.md).

1. Definieren Sie auf der Seite **Servereinstellungen** die Einstellungen für Azure Defender für SQL:

    :::image type="content" source="media/sql-vulnerability-assessment/sql-vulnerability-scan-settings.png" alt-text="Konfigurieren der Überprüfungen für die SQL-Sicherheitsrisikobewertung":::

    1. Konfigurieren Sie ein Speicherkonto zum Speichern der Überprüfungsergebnisse für alle Datenbanken auf dem Server oder in der verwalteten Instanz. Weitere Informationen zu Speicherkonten finden Sie unter [Informationen zu Azure-Speicherkonten](../../storage/common/storage-account-create.md).

        > [!TIP]
        > Weitere Informationen zum Speichern von Überprüfungen zur Sicherheitsrisikobewertung hinter Firewalls und VNETs finden Sie unter [Speichern der Ergebnisse von Überprüfungen zur Sicherheitsrisikobewertung in einem Speicherkonto, auf das hinter Firewalls oder VNETs zugegriffen werden kann](sql-database-vulnerability-assessment-storage.md).

    1. Zum Konfigurieren von Sicherheitsrisikobewertungen für die automatische Durchführung von Überprüfungen zum Erkennen von Sicherheitsfehlkonfigurationen legen Sie **Regelmäßig wiederkehrende Überprüfungen** auf **Ein** fest. Die Ergebnisse werden an die E-Mail-Adressen gesendet, die Sie unter **Überprüfungsberichte senden an** angegeben haben. Sie können E-Mail-Benachrichtigungen auch an Administratoren und Abonnementbesitzer senden, indem Sie **E-Mail-Benachrichtigung auch an Administratoren und Abonnementbesitzer senden** aktivieren.

1. Überprüfungen der SQL-Sicherheitsrisikobewertung können auch bei Bedarf ausgeführt werden:

    1. Wählen Sie auf der Seite **Security Center** der Ressource die Option **Zusätzliche Ergebnisse in der Sicherheitsrisikobewertung anzeigen** aus, um auf die Überprüfungsergebnisse früherer Überprüfungen zuzugreifen.

        :::image type="content" source="media/sql-vulnerability-assessment/view-additional-findings-link.png" alt-text="Öffnen der Überprüfungsergebnisse und der Optionen für manuelle Überprüfung":::

    1. Um eine bedarfsgesteuerte Überprüfung auszuführen, um Ihre Datenbank auf Sicherheitsrisiken zu überprüfen, wählen Sie **Überprüfen** auf der Symbolleiste aus:

        :::image type="content" source="media/sql-vulnerability-assessment/on-demand-vulnerability-scan.png" alt-text="Auswählen von „Überprüfen“, um eine bedarfsgesteuerte Überprüfung der Sicherheitsrisikobewertung Ihrer SQL-Ressource auszuführen":::


  > [!NOTE]
  > Die Überprüfung belastet die Ressourcen nicht und ist sicher. Die Ausführung dauert nur wenige Sekunden und ist vollständig schreibgeschützt. Es werden keine Änderungen an Ihrer Datenbank vorgenommen.

## <a name="remediate-vulnerabilities"></a>Sicherheitsrisiken beheben

Nachdem eine Sicherheitsrisikoüberprüfung abgeschlossen wurde, wird der Bericht im Azure-Portal angezeigt. Der Bericht zeigt Folgendes an:

- Eine Übersicht über Ihren Sicherheitsstatus
- Die Anzahl der gefundenen Probleme
- Eine Zusammenfassung nach Schweregrad der Risiken
- Eine Liste der Ergebnisse für weitere Untersuchungen

:::image type="content" source="media/sql-vulnerability-assessment/sample-sql-vulnerabilities-report.png" alt-text="Beispielüberprüfungsbericht aus der SQL-Sicherheitsrisikobewertung":::

So beheben Sie die ermittelten Sicherheitsrisiken:

1. Werten Sie Ihre Ergebnisse aus, und bestimmen Sie, welche Ergebnisse im Bericht echte Sicherheitsprobleme für Ihre Umgebung sind.

1. Wählen Sie jedes Fehlerergebnis aus, um seine Auswirkungen und den Grund für den Fehler bei der Sicherheitsüberprüfung zu verstehen.

    > [!TIP]
    > Auf der Seite mit den Ergebnisdetails finden Sie Informationen zur Problembehebung.

    :::image type="content" source="media/sql-vulnerability-assessment/examining-vulnerability-findings.gif" alt-text="Untersuchen der Ergebnisse einer Sicherheitsrisikoüberprüfung":::

1. Bei der Überprüfung Ihrer Bewertungsergebnisse können Sie bestimmte Ergebnisse als akzeptable *Baseline* für Ihre Umgebung markieren. Eine Baseline ist im Wesentlichen eine Anpassung der Art, in der die Ergebnisse berichtet werden. Wenn Ergebnisse in nachfolgenden Überprüfungen mit der Baseline übereinstimmen, wird dies als Bestehen gewertet. Nach dem Festlegen des Baselinesicherheitsstatus meldet die Sicherheitsrisikobewertung nur noch Abweichungen von der Baseline. Dadurch können Sie sich auf die relevanten Probleme konzentrieren.

    :::image type="content" source="media/sql-vulnerability-assessment/baseline-approval.png" alt-text="Genehmigen eines Ergebnisses als Baseline für zukünftige Überprüfungen":::

1. Wenn Sie die Baselines ändern, verwenden Sie die Schaltfläche **Überprüfen**, um eine bedarfsgesteuerte Überprüfung auszuführen und den angepassten Bericht anzuzeigen. Alle Ergebnisse, die Sie der Baseline hinzugefügt haben, werden jetzt unter **Bestanden** mit der Angabe angezeigt, dass sie aufgrund der Baselineänderungen bestanden haben.

    :::image type="content" source="media/sql-vulnerability-assessment/passed-per-custom-baseline.png" alt-text="Bestandene Bewertungen mit der Angabe, dass sie aufgrund der benutzerdefinierten Baseline bestanden haben":::

Ihre Sicherheitsrisikobewertung kann nun verwendet werden, um sicherzustellen, dass Ihre Datenbank über ein hohes Maß an Sicherheit verfügt und dass die Organisationsrichtlinien erfüllt werden. 

## <a name="advanced-capabilities"></a>Erweiterte Funktionen

### <a name="export-an-assessment-report"></a>Exportieren eines Bewertungsberichts

Wählen Sie **Überprüfungsergebnisse exportieren** aus, um einen herunterladbaren Excel-Bericht der Überprüfungsergebnisse zu erstellen. Dieser Bericht enthält eine Registerkarte mit einer Zusammenfassung der Bewertung – einschließlich aller Überprüfungen mit Fehlern. Er enthält auch die Registerkarte **Ergebnisse** mit den vollständigen Ergebnissen der Überprüfung. Die Ergebnisse beinhalten alle ausgeführten Überprüfungen und die jeweiligen Ergebnisdetails.

### <a name="view-scan-history"></a>Anzeigen des Überprüfungsverlaufs

Wählen Sie im Bereich der Sicherheitsrisikobewertung die Option **Überprüfungsverlauf** aus, um einen Verlauf aller zuvor für diese Datenbank ausgeführten Überprüfungen anzuzeigen. Wählen Sie eine bestimmte Überprüfung in der Liste aus, um die ausführlichen Ergebnisse dieser Überprüfung anzuzeigen.

## <a name="manage-vulnerability-assessments-programmatically"></a>Programmgesteuertes Verwalten von Sicherheitsrisikobewertungen

### <a name="using-azure-powershell"></a>Verwenden von Azure PowerShell

[!INCLUDE [updated-for-az](../../../includes/updated-for-az.md)]
> [!IMPORTANT]
> Das Azure Resource Manager-Modul von PowerShell wird weiterhin unterstützt, aber alle zukünftigen Entwicklungen erfolgen für das Az.Sql-Modul. Informationen zu diesen Cmdlets finden Sie unter [AzureRM.Sql](/powershell/module/AzureRM.Sql/). Die Argumente für die Befehle im Az-Modul und den AzureRm-Modulen sind im Wesentlichen identisch.

Sie können die Azure PowerShell-Cmdlets verwenden, um Ihre Sicherheitsrisikobewertungen programmgesteuert zu verwalten. Die unterstützten Cmdlets sind die folgenden:

| Cmdlet-Name als Link | BESCHREIBUNG |
| :-------------------- | :---------- |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Löscht die Baseline für die Regel zur Sicherheitsrisikobewertung.<br/>Legen Sie zunächst die Baseline fest, bevor Sie dieses Cmdlet zum Löschen verwenden. |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting) | Löscht die Einstellungen für die Sicherheitsrisikobewertung einer Datenbank. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Löscht die Baseline für die Regel zur Sicherheitsrisikobewertung einer verwalteten Datenbank.<br/>Legen Sie zunächst die Baseline fest, bevor Sie dieses Cmdlet zum Löschen verwenden. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Löscht die Einstellungen der Sicherheitsrisikobewertung einer verwalteten Datenbank. |
| [Clear-AzSqlInstanceVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-AzSqlInstanceVulnerabilityAssessmentSetting) | Löscht die Einstellungen der Sicherheitsrisikobewertung einer verwalteten Instanz. |
| [Convert-AzSqlDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan) | Konvertiert die Überprüfungsergebnisse der Sicherheitsrisikobewertung einer Datenbank in eine Excel-Datei. |
| [Convert-AzSqlInstanceDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Convert-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | Konvertiert die Überprüfungsergebnisse der Sicherheitsrisikobewertung einer verwalteten Datenbank in eine Excel-Datei. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Ruft die Baseline für die Regel zur Sicherheitsrisikobewertung einer Datenbank für eine angegebene Regel ab. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Ruft die Baseline für die Regel zur Sicherheitsrisikobewertung einer verwalteten Datenbank für eine angegebene Regel ab. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentScanRecord](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord) | Ruft alle Überprüfungsdatensätze für die Sicherheitsrisikobewertung ab, die der angegebenen Datenbank zugeordnet sind. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord) | Ruft alle Überprüfungsdatensätze für die Sicherheitsrisikobewertung ab, die der angegebenen verwalteten Datenbank zugeordnet sind. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting) | Gibt die Einstellungen für die Sicherheitsrisikobewertung einer Datenbank zurück. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Gibt die Einstellungen der Sicherheitsrisikobewertung einer verwalteten Datenbank zurück. |
| [Set-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Legt die Baseline für die Regel zur Sicherheitsrisikobewertung fest. |
| [Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Legt die Baseline für die Regel zur Sicherheitsrisikobewertung einer verwalteten Datenbank fest. |
| [Start-AzSqlDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan) | Löst den Start einer Überprüfung zur Sicherheitsrisikobewertung einer Datenbank aus. |
| [Start-AzSqlInstanceDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Start-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | Löst den Start einer Überprüfung zur Sicherheitsrisikobewertung einer verwalteten Datenbank aus. |
| [Update-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting) | Aktualisiert die Einstellungen für die Sicherheitsrisikobewertung einer Datenbank. |
| [Update-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Aktualisiert die Einstellungen der Sicherheitsrisikobewertung einer verwalteten Datenbank. |
| [Update-AzSqlInstanceVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-AzSqlInstanceVulnerabilityAssessmentSetting) | Aktualisiert die Einstellungen der Sicherheitsrisikobewertung einer verwalteten Instanz. |
| &nbsp; | &nbsp; |

Ein Skriptbeispiel finden Sie im Blogbeitrag [Azure SQL Vulnerability Assessment PowerShell support (SQL-Sicherheitsrisikobewertung: Unterstützung für PowerShell)](/archive/blogs/sqlsecurity/azure-sql-vulnerability-assessment-now-with-powershell-support).

### <a name="using-resource-manager-templates"></a>Verwenden von Resource Manager-Vorlagen

Wenn Sie mithilfe von Azure Resource Manager-Vorlagen Baselines für Sicherheitsrisikobewertungen konfigurieren, müssen Sie den `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines`-Typ verwenden.

Stellen Sie sicher, dass Sie `vulnerabilityAssessments` aktiviert haben, bevor Sie die Grundwerte hinzufügen.

Das folgende Beispiel veranschaulicht, wie die Baselineregel VA2065 für die `master`-Datenbank und die Baselineregel VA1143 für die `user`-Datenbank als Ressourcen in einer Resource Manager-Vorlage definiert werden.

```json
   "resources": [
      {
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "FirewallRuleName3",
                     "StartIpAddress",
                     "EndIpAddress"
                  ]
               },
               {
                  "result": [
                     "FirewallRuleName4",
                     "62.92.15.68",
                     "62.92.15.68"
                  ]
               }
            ]
         },
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
         "dependsOn": [
            "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
         ],
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "dbo"
                  ]
               }
            ]
         }
      }
   ]
```

Für die `master`- und die `user`-Datenbank werden die Ressourcennamen unterschiedlich definiert:

- Masterdatenbank: "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/<b>master</b>')]",
- Benutzerdatenbank: "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/<b>default</b>')]",

Um boolesche Typen als „true/false“ zu behandeln, legen Sie das Baselineergebnis mit binärer Eingabe (beispielsweise „1“/„0“) fest.

```json
   {
      "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
      "apiVersion": "2018-06-01-preview",
      "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",

      "dependsOn": [
         "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
      ],

      "properties": {
         "baselineResults": [
            {
               "result": [
                  "1"
               ]
            }
         ]
      }

   }
```

## <a name="next-steps"></a>Nächste Schritte  

- Weitere Informationen zu [Azure Defender für SQL](azure-defender-for-sql.md).
- Informieren Sie sich ausführlicher über die [Datenermittlung und -klassifizierung](data-discovery-and-classification-overview.md).
- Erfahren Sie mehr über das [Speichern der Ergebnisse von Überprüfungen zur Sicherheitsrisikobewertung in einem Speicherkonto, auf das hinter Firewalls und VNETs zugegriffen werden kann](sql-database-vulnerability-assessment-storage.md).